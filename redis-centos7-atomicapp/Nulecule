---
specversion: 0.0.2
id: redis-atomicapp

metadata:
  name: Redis App
  appversion: 0.0.1
  description: Redis Atomic App

params:
  - name: image
    description: The redis master part
    default: jasonbrooks/redis
  - name: master_hostport
    description: The host TCP port as the external endpoint
    default: 6379
  - name: slave_hostport
    description: The host TCP port as the external endpoint
    default: 6380
  - name: master_service
    description: Name of redis master service
    default: redis-master
  - name: slave_service
    description: Name of redis slave service
    default: redis-slave

graph:
  - name: redismaster-app
    params:
        image: $image
        hostport: $master_hostport
        service: $master_service
    artifacts:
      kubernetes:
        - file://artifacts/kubernetes/redis-master-controller.json
        - file://artifacts/kubernetes/redis-master-service.json
      docker:
        - file://artifacts/docker/redis-master_run
  - name: redisslave-app
    params:
        image: $image
        master_hostport: $master_hostport
        hostport: $slave_hostport
        service: $slave_service
    artifacts:
      kubernetes:
        - file://artifacts/kubernetes/redis-slave-controller.json
        - file://artifacts/kubernetes/redis-slave-service.json
      docker:
        - file://artifacts/docker/redis-slave_run

